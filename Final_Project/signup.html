<html>

<head>
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  </body>
</html>
</head>

<body class="bg-body-tertiary mt-5 pt-5">
    
<div id="navbar" ></div>





<div class="text d-flex justify-content-center align-items-center pt-5">
  <h1>Register Now!</h1>
</div>

<div class="inner m-5">
    <div class="mb-3 row">
  <label class="col-sm-2 col-form-label">Name</label>
  <div class="col-sm-10">
    <input type="name" class="form-control" id="name">
  </div>
</div>




    <div class="mb-3 row">
  <label class="col-sm-2 col-form-label">Email</label>
  <div class="col-sm-10">
    <input type="email" class="form-control" id="email">
  </div>
</div>
<div class="mb-3 row">
  <label for="inputPassword" class="col-sm-2 col-form-label">Password</label>
  <div class="col-sm-10">
    <input type="password" class="form-control" id="pass">
  </div>
</div>
</div>

<div class="btn d-flex justify-content-center align-items-center">

  <button  onclick="signup()" class="bg-success text-white p-3 rounded-5 w-25">Register</button>

</div>

<div>
  <p id="msg"></p>
</div>



<script>


const supabaseclient =supabase.createClient( // el function di btrg3 object data[..] w error(lw mwgod bykon fih message 3obar 3n object fih message)
  // to open connction with supabase w const 3shan da connection sabet msh hyt3'yar

"https://eyenvepjdscszapilzdi.supabase.co", // da url 3shan yroh lldatabase supabase nfsha
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV5ZW52ZXBqZHNjc3phcGlsemRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzNTMzMTEsImV4cCI6MjA4NjkyOTMxMX0.UIjUXMi3VSEX6zBOpoasYCWHslSGADmyPMkQA0bQ4F4" // da zy el password 3shan ysma7 yt3amel m3 supabase
)

async function signup(){ //async means fi hagat fl function di m7taga entzar 

let msg = document.getElementById("msg");

let name=document.getElementById("name").value

let email=document.getElementById("email").value
let pass=document.getElementById("pass").value



const {data,error}=await supabaseclient.auth.signUp({ 
  // await means estnna lama el natyga ttl3 then ed5ol el satr el b3do // 5od mn el natyga el data wl error
//bystna natygt el edafa (btstna el rd ng7 wala fshl)

email:email,
password:pass

}) 



if(error){

  msg.innerText=error.message
  return;
}



const userid=data.user.id

const {error: inserterror} = await supabaseclient //supabase byrg3 object data w error f 5znt object el error f variable inserterror
.from("users")
.insert([{id:userid, name:name, email:email}])



if(inserterror){msg.innerText=inserterror.message}
else{msg.innerText="Done"
setTimeout(()=>location.href="signin.html",1500 )} // set timeout hena 3shan ykon fih sanya yshof el msg






}

















// call el navbar
  fetch("navbar.html")
  .then(res=>res.text())
  .then(html =>{

    document.getElementById("navbar").innerHTML=html
  })




 src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" 
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/js/all.min.js"
        
</script>
</body>
</html>